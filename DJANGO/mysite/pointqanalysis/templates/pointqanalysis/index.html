{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Custom Navbar Template with Logo for Bootstrap 3</title>

    <!-- Bootstrap core CSS -->
    <link href="{% static 'pointqanalysis/css/bootstrap.css' %}" rel="stylesheet">

    <!-- Add custom CSS here -->
    <link href="{% static 'pointqanalysis/css/logo-nav.css' %}" rel="stylesheet">
    <link href="{% static 'pointqanalysis/css/zoombox.css' %}" rel="stylesheet">

</head>

<body>

    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">
                    <img src="{% static 'pointqanalysis/images/logo.gif' %}" alt="">
                </a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#">Queues</a>
                    </li>
                    <li>
                        <a href="#">Flows</a>
                    </li>
                    <li>
                        <a href="#">Travel Time</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </nav>

    <div class="container">
      <div id='left_tree'>
        <h2>Selected links:</h2>
        <ul>
          
        </ul>
      </div>
      <div id="map-canvas"/>
    </div>
    <!-- /.container -->

    <!-- JavaScript -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="{% static 'pointqanalysis/js/zoombox.js' %}"></script>
    <script type="text/javascript"  src="{% static 'pointqanalysis/js/bootstrap.js' %}"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCoJ26UXM3yhuReCvT9V03jcUTkREcpUVw"></script>
    <script type="text/javascript">
        jQuery(function($){
            $('a.zoombox').zoombox({width:960,height:460,});

            /**
            * Or You can also use specific options
            $('a.zoombox').zoombox({
                theme       : 'zoombox',        //available themes : zoombox,lightbox, prettyphoto, darkprettyphoto, simple
                opacity     : 0.8,              // Black overlay opacity
                duration    : 800,              // Animation duration
                animation   : true,             // Do we have to animate the box ?
                width       : 600,              // Default width
                height      : 400,              // Default height
                gallery     : true,             // Allow gallery thumb view
                autoplay : false                // Autoplay for video
            });
            */
        });
    </script>
    <script type="text/javascript">
        var map;
        var list_links = [];
        function in_array(string, array){
            var result = false;
            for(i=0; i<array.length; i++){
                if(array[i] == string){
                    result = true;
                }
            }
            return result;
        }
        
        function initialize() {
              // Create a simple map.
              map = new google.maps.Map(document.getElementById('map-canvas'), {
              zoom: 16,
              center: {lat: 34.149156, lng: -118.0677}
            });

          // Load a GeoJSON from the same server as our demo.
          map.data.loadGeoJson('{% static 'pointqanalysis/other/network.geojson' %}');
          map.data.setStyle({
            icon: '{% static 'pointqanalysis/images/marker.png' %}',
            strokeColor: '#0019ff',
            strokeOpacity: 0.6,
            strokeWeight: 9,
          });
          // Add infowindow when mouse on an element
          map.data.addListener('mouseover', function(event) {
            var infowindow = new google.maps.InfoWindow({
                content: event.feature.getProperty('id')
            });
            infowindow.setPosition({lat: event.latLng.lat() + 0.00005, lng: event.latLng.lng()});
            infowindow.open(map);
            map.data.addListener('mouseout', function(event) {
              infowindow.close();                    
            });
          });
          // Add the link to the list_links array
          map.data.addListener('click', function(event) {
            if (event.feature.getGeometry().getType() == 'LineString' && !in_array(event.feature.getProperty('id'), list_links))
            {
              var id_li = event.feature.getProperty('id');
              list_links.push(event.feature.getProperty('id'));

              // We create a new element in the list
              var node_li = document.createElement('li');
              node_li.id = event.feature.getProperty('id');
              
              var node_li_delete = document.createElement('img');
              node_li_delete.src = '{% static 'pointqanalysis/images/close.png' %}';
              node_li_delete.onclick = function(){
                node_li.parentNode.removeChild(node_li);
                list_links.splice(list_links.indexOf(id_li), 1);
                console.log(list_links);
              };  
              node_li.appendChild(node_li_delete);
              node_li.appendChild(document.createTextNode('  ' + event.feature.getProperty('id')));
              
              
              // We search of the correct ul element
              var node_ul = document.getElementById('left_tree').getElementsByTagName('ul')[0];
              
              // We add node_li to node_ul
              node_ul.appendChild(node_li);       
            }
          });
          
        }

        google.maps.event.addDomListener(window, 'load', initialize);
      
    </script>
</body>

</html>